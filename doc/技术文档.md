# 技术文档

## 综述

该项目使用物理模拟无人机飞控，以串级PID控制系统控制无人机的位置和姿态，使无人机悬停于目标点上

## 总体结构

分层架构如下：

显示层：将无人机的飞行状态和目标点的位置显示在屏幕上

控制层：在环境中获取无人机的位置，将误差输入控制器，调整无人机旋翼的转速。控制层由PID控制器和串级控制器组成

物理层：进行物理计算，计算如位置，速度，加速度，角速度，角加速度，转动惯量、扭矩，重力、升力等物理量

## 技术选型

项目采用Rust编程语言、Bevy游戏引擎和BevyXPBD物理引擎实现

Rust编程语言是抽象程度高，内存安全，性能接近C/C++的现代编程语言，其所有权机制保证了程序的内存安全，使用Rust的包管理工具Cargo可以快速配置项目的开发环境，诸多优点不一一细说了

Bevy是一款使用Rust语言编写的基于`实体组件系统(ECS)`架构实现的游戏引擎

BevyXPBD为Bevy游戏引擎开发的基于`拓展的基于位置的动力学 Extended Position Based Dynamics(XPBD)`算法实现的物理引擎

之所以采用Bevy游戏引擎，一方面是为了尝试新鲜的ECS架构，另一方面是因为Rust对WebAssembly的支持非常完善，生成的程序不仅可以运行在本机上的窗口，还可以通过WebAssembly运行在浏览器上，实现一次编译，多处运行

## 物理模拟

该物理模拟不考虑风阻等其他外力，无人机只受旋翼升力和重力作用

无人机的物理系统和控制系统参考文章:

四旋翼无人机建模及控制

https://zhuanlan.zhihu.com/p/455984100 

但是没有实现原文中`陀螺力矩`部分，文中提到空气温度、音速、气压、空气密度、磁场强度参数本程序中未考虑

